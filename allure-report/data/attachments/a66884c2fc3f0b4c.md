# Test info

- Name: [UI] [Customers] Table Sorting >> Sort by 'Country' asc
- Location: /home/runner/work/AQA_JS_TS/AQA_JS_TS/Playwright/src/ui/tests/customers/sorting.spec.ts:27:11

# Error details

```
Error: expect(received).toEqual(expected) // deep equality

- Expected  - 39
+ Received  + 39

  Array [
    Object {
      "country": "Belarus",
-     "createdOn": "2025/06/04 12:06:52",
-     "email": "test1749038810756@gmail.com",
-     "name": "Test nxfbtUIZsrndbQXCLzckIdvtrbPrjFJNJMf",
+     "createdOn": "2025/03/08 00:00:46",
+     "email": "user@domain.com",
+     "name": "User",
    },
    Object {
-     "country": "Canada",
-     "createdOn": "2025/06/04 16:14:18",
-     "email": "Retha.Gorczany27@gmail.com",
-     "name": "Name wYNDHAHZWSjNQDUqjdvmVwXbDUgClnJLkVi",
+     "country": "Belarus",
+     "createdOn": "2025/05/16 14:51:10",
+     "email": "Vidal62@hotmail.com",
+     "name": "Name RgLtIBjoPSgdeZLiRlQDfMrgEtjwBbFnFYL",
    },
    Object {
-     "country": "Canada",
-     "createdOn": "2025/06/04 17:07:00",
-     "email": "Clarissa69@yahoo.com",
-     "name": "Name dqhNytFbqyrRmVLhybgEbwyUHKwdcZCvhWj",
+     "country": "Belarus",
+     "createdOn": "2025/05/19 20:40:37",
+     "email": "test1747687236831@gmail.com",
+     "name": "Test pmFiTUfdSIwJMeNFmzIwsEZOHptGYMQxCFR",
    },
    Object {
-     "country": "France",
-     "createdOn": "2025/06/04 12:05:14",
-     "email": "test1749038713622@gmail.com",
-     "name": "Test dtMcloEcKVoheltvWPftosEgceVvKtQvrfU",
+     "country": "Belarus",
+     "createdOn": "2025/05/20 20:47:10",
+     "email": "julytest1747774029893@gmail.com",
+     "name": "Test QbzJuYbtQOqtxwBmuauBfSIdjtVPQDKIvOx",
    },
    Object {
-     "country": "Germany",
-     "createdOn": "2025/06/04 12:04:51",
-     "email": "test1749038690654@gmail.com",
-     "name": "Test DKuAtlEDwzIAOXiUuzZoslwFffqbcfznfoZ",
+     "country": "Belarus",
+     "createdOn": "2025/05/21 14:46:01",
+     "email": "safddsxxfdfsdxxfj1747838761054@gmail.com",
+     "name": "test UwzwMleHFuGkRIEnbfEjUHEbUKGCXRgCBfS",
    },
    Object {
-     "country": "Germany",
-     "createdOn": "2025/06/04 12:08:33",
-     "email": "test1749038912029@gmail.com",
-     "name": "Test FmVjyrVTVIWUnalqjjtLBcemFYQstBtCBnw",
+     "country": "Belarus",
+     "createdOn": "2025/05/21 14:47:11",
+     "email": "safddsxxfdfsdxxfj1747838830502@gmail.com",
+     "name": "test ynDCdKivyEQZODSMYyqCfvHhbjmqgLeRiuK",
    },
    Object {
-     "country": "Great Britain",
-     "createdOn": "2025/06/04 12:06:51",
-     "email": "test1749038810549@gmail.com",
-     "name": "Test dkMgbuJQNsZzdNHVUTCopHaRwtdvUjmHQsX",
+     "country": "Belarus",
+     "createdOn": "2025/05/21 20:22:39",
+     "email": "safddsxxfdfsdxxfj1747858961398@gmail.com",
+     "name": "test MjkanDRQHVaHjcWybdpxiyrLApPesvndsMm",
    },
    Object {
-     "country": "Ukraine",
-     "createdOn": "2025/06/04 17:07:02",
-     "email": "Napoleon61@yahoo.com",
-     "name": "Name TFHGxDEYJCAXRDttMWqgkEswRELaBWhMUOJ",
+     "country": "Belarus",
+     "createdOn": "2025/05/21 20:24:02",
+     "email": "safddsxxfdfsdxxfj1747859045590@gmail.com",
+     "name": "test rWjoNlERFPTDXuZqnqTElPqayTjLRCFYDwA",
    },
    Object {
-     "country": "USA",
-     "createdOn": "2025/06/04 12:05:14",
-     "email": "test1749038713619@gmail.com",
-     "name": "Test peSUjbNBZdhtoawtMHVExemMzyOrtXYykCJ",
+     "country": "Belarus",
+     "createdOn": "2025/05/22 17:28:49",
+     "email": "test1747934929650@gmail.com",
+     "name": "Test WtPVWXnnCOMmLbagXpskFspJwJYdFTnOSOD",
    },
    Object {
-     "country": "USA",
-     "createdOn": "2025/06/04 17:04:36",
-     "email": "Kane_Strosin-Schultz90@hotmail.com",
-     "name": "Name XBiVHKoWnpETvCEQTMsnKclVzSLBeEgSLmB",
+     "country": "Belarus",
+     "createdOn": "2025/05/22 17:58:04",
+     "email": "test1747936680602@gmail.com",
+     "name": "Test bgbPboplWvLbbuDUyqbyVkyueCvrhPZOYAJ",
    },
  ]
    at CustomersListService.sortCustomersAndVerify (/home/runner/work/AQA_JS_TS/AQA_JS_TS/Playwright/src/ui/services/customers/customers.service.ts:86:24)
    at /home/runner/work/AQA_JS_TS/AQA_JS_TS/Playwright/src/ui/tests/customers/sorting.spec.ts:28:9
```

# Page snapshot

```yaml
- img
- text: Sales Portal
- separator
- list:
  - listitem:
    - link "Home":
      - /url: "#"
      - img
      - text: Home
  - listitem:
    - link "Orders":
      - /url: "#"
      - img
      - text: Orders
  - listitem:
    - link "Products":
      - /url: "#"
      - img
      - text: Products
  - listitem:
    - link "Customers":
      - /url: "#"
      - img
      - text: Customers
  - listitem:
    - link "Managers":
      - /url: "#"
      - img
      - text: Managers
- switch "Dark mode"
- text: Dark mode
- separator
- link "RELOGIN!":
  - /url: "#"
  - strong: RELOGIN!
- text:  17
- heading "Customers List" [level=2]
- button "+ Add Customer"
- searchbox "Search"
- button " Search" [disabled]
- button " Filter"
- table:
  - rowgroup:
    - row "Email Name Country  Created On Actions":
      - columnheader "Email"
      - columnheader "Name"
      - columnheader "Country "
      - columnheader "Created On"
      - columnheader "Actions"
  - rowgroup:
    - row "user@domain.com User Belarus 2025/03/08 00:00:46   ":
      - cell "user@domain.com"
      - cell "User"
      - cell "Belarus"
      - cell "2025/03/08 00:00:46"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "Vidal62@hotmail.com Name RgLtIBjoPSgdeZLiRlQDfMrgEtjwBbFnFYL Belarus 2025/05/16 14:51:10   ":
      - cell "Vidal62@hotmail.com"
      - cell "Name RgLtIBjoPSgdeZLiRlQDfMrgEtjwBbFnFYL"
      - cell "Belarus"
      - cell "2025/05/16 14:51:10"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "test1747687236831@gmail.com Test pmFiTUfdSIwJMeNFmzIwsEZOHptGYMQxCFR Belarus 2025/05/19 20:40:37   ":
      - cell "test1747687236831@gmail.com"
      - cell "Test pmFiTUfdSIwJMeNFmzIwsEZOHptGYMQxCFR"
      - cell "Belarus"
      - cell "2025/05/19 20:40:37"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "julytest1747774029893@gmail.com Test QbzJuYbtQOqtxwBmuauBfSIdjtVPQDKIvOx Belarus 2025/05/20 20:47:10   ":
      - cell "julytest1747774029893@gmail.com"
      - cell "Test QbzJuYbtQOqtxwBmuauBfSIdjtVPQDKIvOx"
      - cell "Belarus"
      - cell "2025/05/20 20:47:10"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "safddsxxfdfsdxxfj1747838761054@gmail.com test UwzwMleHFuGkRIEnbfEjUHEbUKGCXRgCBfS Belarus 2025/05/21 14:46:01   ":
      - cell "safddsxxfdfsdxxfj1747838761054@gmail.com"
      - cell "test UwzwMleHFuGkRIEnbfEjUHEbUKGCXRgCBfS"
      - cell "Belarus"
      - cell "2025/05/21 14:46:01"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "safddsxxfdfsdxxfj1747838830502@gmail.com test ynDCdKivyEQZODSMYyqCfvHhbjmqgLeRiuK Belarus 2025/05/21 14:47:11   ":
      - cell "safddsxxfdfsdxxfj1747838830502@gmail.com"
      - cell "test ynDCdKivyEQZODSMYyqCfvHhbjmqgLeRiuK"
      - cell "Belarus"
      - cell "2025/05/21 14:47:11"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "safddsxxfdfsdxxfj1747858961398@gmail.com test MjkanDRQHVaHjcWybdpxiyrLApPesvndsMm Belarus 2025/05/21 20:22:39   ":
      - cell "safddsxxfdfsdxxfj1747858961398@gmail.com"
      - cell "test MjkanDRQHVaHjcWybdpxiyrLApPesvndsMm"
      - cell "Belarus"
      - cell "2025/05/21 20:22:39"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "safddsxxfdfsdxxfj1747859045590@gmail.com test rWjoNlERFPTDXuZqnqTElPqayTjLRCFYDwA Belarus 2025/05/21 20:24:02   ":
      - cell "safddsxxfdfsdxxfj1747859045590@gmail.com"
      - cell "test rWjoNlERFPTDXuZqnqTElPqayTjLRCFYDwA"
      - cell "Belarus"
      - cell "2025/05/21 20:24:02"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "test1747934929650@gmail.com Test WtPVWXnnCOMmLbagXpskFspJwJYdFTnOSOD Belarus 2025/05/22 17:28:49   ":
      - cell "test1747934929650@gmail.com"
      - cell "Test WtPVWXnnCOMmLbagXpskFspJwJYdFTnOSOD"
      - cell "Belarus"
      - cell "2025/05/22 17:28:49"
      - cell "  ":
        - button ""
        - button ""
        - button ""
    - row "test1747936680602@gmail.com Test bgbPboplWvLbbuDUyqbyVkyueCvrhPZOYAJ Belarus 2025/05/22 17:58:04   ":
      - cell "test1747936680602@gmail.com"
      - cell "Test bgbPboplWvLbbuDUyqbyVkyueCvrhPZOYAJ"
      - cell "Belarus"
      - cell "2025/05/22 17:58:04"
      - cell "  ":
        - button ""
        - button ""
        - button ""
- text: "Items on page:"
- combobox:
  - option "10" [selected]
  - option "25"
  - option "50"
  - option "100"
- button "" [disabled]
- button "1"
- button "2"
- button "3"
- button "4"
- button "5"
- button "6"
- button "7"
- button "8"
- text: ...
- button "31"
- button ""
```

# Test source

```ts
   1 | import { AddNewCustomerPage } from '../../pages/customers/addNewCustomer.page.js';
   2 | import { CustomersListPage } from '../../pages/customers/customers.page.js';
   3 | import { expect, Page } from '@playwright/test';
   4 | import { COUNTRIES, CUSTOMERS_COLUMN_NAME, ICustomersTable } from '../../../data/types/customers.types.js';
   5 | import { TABLE_MESSAGES } from '../../../data/customers/customersList.js';
   6 | import { TOAST_MESSAGES } from '../../../data/messages/messages.js';
   7 | import _ from 'lodash';
   8 | import { validateToastMessage } from '../../../utils/validation/toastMessage.js';
   9 | import { logStep } from '../../../utils/report/logStep.js';
   10 |
   11 | export class CustomersListService {
   12 |   private customersPage: CustomersListPage;
   13 |   private addNewCustomerPage: AddNewCustomerPage;
   14 |   constructor(protected page: Page) {
   15 |     this.customersPage = new CustomersListPage(page);
   16 |     this.addNewCustomerPage = new AddNewCustomerPage(page);
   17 |   }
   18 |
   19 |   private columnKeyMap: Record<CUSTOMERS_COLUMN_NAME, keyof ICustomersTable> = {
   20 |     [CUSTOMERS_COLUMN_NAME.EMAIL]: 'email',
   21 |     [CUSTOMERS_COLUMN_NAME.NAME]: 'name',
   22 |     [CUSTOMERS_COLUMN_NAME.COUNTRY]: 'country',
   23 |     [CUSTOMERS_COLUMN_NAME.CREATED_ON]: 'createdOn',
   24 |   };
   25 |
   26 |   async openAddNewCustomerPage() {
   27 |     await this.customersPage.clickOnAddNewCustomer();
   28 |     await this.customersPage.waitForSpinnerToHide();
   29 |     await this.addNewCustomerPage.waitForOpened();
   30 |   }
   31 |
   32 |   private async repeatSortAction(action: () => Promise<void>, clickCount: number = 1) {
   33 |     for (let i = 0; i < clickCount; i++) {
   34 |       await action();
   35 |       await this.customersPage.waitForSpinnerToHide();
   36 |     }
   37 |   }
   38 |
   39 |   @logStep()
   40 |   private async clickToSortColumn(column: CUSTOMERS_COLUMN_NAME, direction: 'asc' | 'desc') {
   41 |     let clickCount: 1 | 2;
   42 |     direction === 'asc' ? (clickCount = 1) : (clickCount = 2);
   43 |     await this.repeatSortAction(() => this.customersPage.clickOnColumnHeaderToSort(column), clickCount);
   44 |   }
   45 |
   46 |   @logStep()
   47 |   private async getAllCustomersUI() {
   48 |     const data = await this.customersPage.getCustomersColumns();
   49 |     const customers: ICustomersTable[] = [];
   50 |     for (let i = 0; i < data[0].length; i++) {
   51 |       const countryStr = data[2][i];
   52 |       const countryEnum = countryStr as COUNTRIES;
   53 |       customers.push({ email: data[0][i], name: data[1][i], country: countryEnum, createdOn: data[3][i] });
   54 |     }
   55 |     return customers;
   56 |   }
   57 |
   58 |   private async sortCustomersArray(column: keyof ICustomersTable, direction: 'asc' | 'desc') {
   59 |     const customers = await this.getAllCustomersUI();
   60 |     customers.sort((a, b) => {
   61 |       const compareString = (valueA: string, valueB: string) =>
   62 |         direction === 'asc' ? valueA.localeCompare(valueB) : valueB.localeCompare(valueA);
   63 |
   64 |       const compareDates = (dateA: string, dateB: string) =>
   65 |         direction === 'asc'
   66 |           ? new Date(dateA).getTime() - new Date(dateB).getTime()
   67 |           : new Date(dateB).getTime() - new Date(dateA).getTime();
   68 |
   69 |       if (column === 'createdOn') {
   70 |         return compareDates(a.createdOn, b.createdOn);
   71 |       }
   72 |
   73 |       const primaryComparison = compareString(a[column], b[column]);
   74 |       return primaryComparison !== 0 ? primaryComparison : compareDates(a.createdOn, b.createdOn);
   75 |     });
   76 |     return customers;
   77 |   }
   78 |
   79 |   @logStep()
   80 |   async sortCustomersAndVerify(column: CUSTOMERS_COLUMN_NAME, direction: 'asc' | 'desc') {
   81 |     const key = this.columnKeyMap[column];
   82 |     const expectedData = await this.sortCustomersArray(key, direction);
   83 |     await this.clickToSortColumn(column, direction);
   84 |
   85 |     const actualData = await this.getAllCustomersUI();
>  86 |     expect(actualData).toEqual(expectedData);
      |                        ^ Error: expect(received).toEqual(expected) // deep equality
   87 |   }
   88 |
   89 |   @logStep()
   90 |   async validateToastMessageAndClose(expectedMessage: string) {
   91 |     await validateToastMessage(this.customersPage, expectedMessage);
   92 |     await this.customersPage.closeToastMessage();
   93 |   }
   94 |
   95 |   @logStep()
   96 |   async validateCustomerCreatedMessage() {
   97 |     await this.validateToastMessageAndClose(TOAST_MESSAGES.CUSTOMER.CREATED);
   98 |   }
   99 |
  100 |   @logStep()
  101 |   async validateEmptyTable(message?: string) {
  102 |     const actualMessage = await this.customersPage.getEmptyTableMessage();
  103 |     expect(actualMessage).toEqual(message ?? TABLE_MESSAGES.EMPTY_TABLE);
  104 |   }
  105 | }
  106 |
```